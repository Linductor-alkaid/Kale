# Kale è‡ªåŠ¨åŒ–å¼€å‘æŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•ä½¿ç”¨ `kale_auto_dev.sh` è„šæœ¬æ¥è‡ªåŠ¨åŒ–è¿è¡Œå¤šä¸ª Claude Code å¼€å‘ä¼šè¯ã€‚

## å¿«é€Ÿå¼€å§‹

```bash
# è¿è¡Œ 5 æ¬¡å¼€å‘ä¼šè¯
./kale_auto_dev.sh 5

# ä½¿ç”¨ Opus æ¨¡å‹è¿è¡Œ 10 æ¬¡
./kale_auto_dev.sh 10 --model opus

# é¢„è§ˆå°†è¦æ‰§è¡Œçš„å‘½ä»¤ï¼ˆä¸å®é™…è¿è¡Œï¼‰
./kale_auto_dev.sh 3 --dry-run

# ä»ä¸Šæ¬¡ä¸­æ–­å¤„ç»§ç»­
./kale_auto_dev.sh --continue
```

## å·¥ä½œåŸç†

æ¯æ¬¡ä¼šè¯è‡ªåŠ¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ğŸ“– è¯»å–çŠ¶æ€                                         â”‚
â”‚     - claude-progress.txtï¼ˆå½“å‰è¿›åº¦ï¼‰                    â”‚
â”‚     - feature_list.jsonï¼ˆåŠŸèƒ½åˆ—è¡¨ï¼‰                      â”‚
â”‚     - è¿è¡Œ init.sh éªŒè¯ç¯å¢ƒ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ğŸ“‹ é€‰æ‹©ä»»åŠ¡                                         â”‚
â”‚     - æ‰¾åˆ° status="pending" çš„åŠŸèƒ½                       â”‚
â”‚     - æ£€æŸ¥ä¾èµ–æ˜¯å¦å·²å®Œæˆ                                 â”‚
â”‚     - é€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„ï¼ˆcritical/highï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ğŸ”¨ å®ç°åŠŸèƒ½                                         â”‚
â”‚     - æŒ‰ç…§ steps é€ä¸€å®ç°                                â”‚
â”‚     - å‚è€ƒè®¾è®¡æ–‡æ¡£                                       â”‚
â”‚     - éµå¾ªä»£ç é£æ ¼                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. âœ… æµ‹è¯•éªŒè¯                                         â”‚
â”‚     - æ„å»ºé¡¹ç›®                                           â”‚
â”‚     - è¿è¡Œæµ‹è¯•                                           â”‚
â”‚     - æ ¹æ® test_verification éªŒè¯                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. ğŸ“ æ›´æ–°çŠ¶æ€                                         â”‚
â”‚     - æ›´æ–° feature_list.jsonï¼ˆstatusâ†’completedï¼‰        â”‚
â”‚     - æ›´æ–° claude-progress.txtï¼ˆæ·»åŠ è¿›åº¦è®°å½•ï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. ğŸ’¾ æäº¤ä»£ç                                          â”‚
â”‚     - git add .                                         â”‚
â”‚     - git commitï¼ˆæè¿°æ€§æ¶ˆæ¯ï¼‰                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ—¥å¿—æ–‡ä»¶

æ‰€æœ‰æ—¥å¿—å­˜å‚¨åœ¨ `.claude_sessions/` ç›®å½•ï¼š

```
.claude_sessions/
â”œâ”€â”€ auto_dev_20260212_213231.log    # ä¸»æ—¥å¿—ï¼ˆæ—¶é—´æˆ³å‘½åï¼‰
â”œâ”€â”€ session_log.txt                  # ä¼šè¯å†å²è®°å½•
â”œâ”€â”€ prompt_session_1.txt             # ä¼šè¯ 1 çš„ prompt
â”œâ”€â”€ output_session_1.txt             # ä¼šè¯ 1 çš„è¾“å‡º
â”œâ”€â”€ prompt_session_2.txt             # ä¼šè¯ 2 çš„ prompt
â””â”€â”€ output_session_2.txt             # ä¼šè¯ 2 çš„è¾“å‡º
```

## æŸ¥çœ‹è¿›åº¦

```bash
# æŸ¥çœ‹æœ€è¿‘çš„åŠŸèƒ½å®Œæˆæƒ…å†µ
cat claude-progress.txt | grep COMPLETED | tail -10

# æŸ¥çœ‹åŠŸèƒ½ç»Ÿè®¡
grep -c '"status": "completed"' feature_list.json
grep -c '"status": "pending"' feature_list.json

# æŸ¥çœ‹æœ€è¿‘çš„æäº¤
git log --oneline -10

# æŸ¥çœ‹ä¼šè¯æ—¥å¿—
cat .claude_sessions/session_log.txt
```

## æƒé™å¤„ç†

è„šæœ¬ä½¿ç”¨ `--permission-mode acceptEdits` å‚æ•°ï¼Œè¿™æ„å‘³ç€ï¼š
- âœ… è‡ªåŠ¨æ¥å—æ–‡ä»¶ç¼–è¾‘
- âœ… è‡ªåŠ¨æ¥å—å·¥å…·ä½¿ç”¨
- âš ï¸  ä»ç„¶ä¼šåœ¨æŸäº›æ“ä½œå‰æç¤ºï¼ˆå¦‚å±é™©æ“ä½œï¼‰

å¦‚æœéœ€è¦å®Œå…¨è‡ªåŠ¨åŒ–ï¼ˆæ— äººå€¼å®ˆï¼‰ï¼Œå¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
export CLAUDE_NON_INTERACTIVE=true
./kale_auto_dev.sh 5
```

**æ³¨æ„**ï¼šå®Œå…¨è‡ªåŠ¨åŒ–æ¨¡å¼éœ€è¦ç¡®ä¿é¡¹ç›®ç›®å½•æ˜¯å¯ä¿¡çš„ã€‚

## ä¸­æ–­å’Œæ¢å¤

å¦‚æœè„šæœ¬è¢«ä¸­æ–­ï¼ˆCtrl+C æˆ–é”™è¯¯ï¼‰ï¼š
```bash
# æŸ¥çœ‹æœ€åä¸€ä¸ªä¼šè¯ç¼–å·
grep "å¼€å‘ä¼šè¯ #" .claude_sessions/session_log.txt | tail -1

# ä»ä¸­æ–­å¤„ç»§ç»­
./kale_auto_dev.sh --continue
```

## é«˜çº§ç”¨æ³•

### æŒ‡å®šæ¨¡å‹

```bash
# ä½¿ç”¨ Opus 4.6ï¼ˆæ›´å¼ºå¤§ï¼Œä½†æ›´æ…¢ï¼‰
./kale_auto_dev.sh 5 --model opus

# ä½¿ç”¨ Haikuï¼ˆæ›´å¿«ï¼Œé€‚åˆç®€å•ä»»åŠ¡ï¼‰
./kale_auto_dev.sh 10 --model haiku
```

### åå°è¿è¡Œ

```bash
# ä½¿ç”¨ nohup åœ¨åå°è¿è¡Œ
nohup ./kale_auto_dev.sh 100 > auto_dev.out 2>&1 &

# æŸ¥çœ‹è¾“å‡º
tail -f auto_dev.out

# æŸ¥çœ‹è¿›åº¦
tail -f .claude_sessions/session_log.txt
```

### ç›‘æ§è¿›åº¦

```bash
# å®æ—¶æŸ¥çœ‹åŠŸèƒ½å®Œæˆè¿›åº¦
watch -n 10 'echo "å·²å®Œæˆ: $(grep -c "completed" feature_list.json), å¾…å®Œæˆ: $(grep -c "pending" feature_list.json)"'

# å®æ—¶æŸ¥çœ‹æœ€è¿‘çš„æäº¤
watch -n 10 "git log --oneline -3"
```

## æ•…éšœæ’é™¤

### é—®é¢˜ï¼šClaude å‘½ä»¤æœªæ‰¾åˆ°

```bash
# æ£€æŸ¥ Claude Code æ˜¯å¦å®‰è£…
which claude

# å¦‚æœæœªå®‰è£…ï¼Œè¯·å‚è€ƒ Claude Code æ–‡æ¡£è¿›è¡Œå®‰è£…
```

### é—®é¢˜ï¼šæƒé™è¢«æ‹’ç»

```bash
# ç¡®ä¿è„šæœ¬å¯æ‰§è¡Œ
chmod +x kale_auto_dev.sh
```

### é—®é¢˜ï¼šä¼šè¯å¤±è´¥

```bash
# æŸ¥çœ‹å¤±è´¥ä¼šè¯çš„è¾“å‡º
cat .claude_sessions/output_session_<N>.txt

# æŸ¥çœ‹ä¸»æ—¥å¿—
cat .claude_sessions/auto_dev_*.log
```

### é—®é¢˜ï¼šåŠŸèƒ½çŠ¶æ€æœªæ›´æ–°

æ£€æŸ¥ Claude æ˜¯å¦æœ‰æƒé™ä¿®æ”¹æ–‡ä»¶ï¼š
```bash
# æµ‹è¯•å†™å…¥æƒé™
echo "test" >> feature_list.json
```

## æœ€ä½³å®è·µ

1. **ä»å°‘é‡ä¼šè¯å¼€å§‹**ï¼šå…ˆç”¨ `--dry-run` é¢„è§ˆï¼Œç„¶åè¿è¡Œ 1-2 æ¬¡æµ‹è¯•
2. **å®šæœŸæ£€æŸ¥è¿›åº¦**ï¼šä½¿ç”¨ `git log` å’Œ `cat claude-progress.txt` æŸ¥çœ‹è¿›åº¦
3. **ä¿æŒä¼šè¯ç®€çŸ­**ï¼šæ¯ä¸ªä¼šè¯åªå®ç°ä¸€ä¸ªåŠŸèƒ½ï¼Œç¡®ä¿è´¨é‡
4. **ä½¿ç”¨ --continue**ï¼šä¸­æ–­åç»§ç»­ï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹
5. **å¤‡ä»½é‡è¦æ•°æ®**ï¼šåœ¨è¿è¡Œå¤§é‡ä¼šè¯å‰ï¼Œè€ƒè™‘å¤‡ä»½æˆ–åˆ›å»ºåˆ†æ”¯

## ç¤ºä¾‹å·¥ä½œæµ

```bash
# 1. ç¡®ä¿é¡¹ç›®åœ¨å¹²å‡€çŠ¶æ€
git status
./init.sh

# 2. é¢„è§ˆå³å°†è¿è¡Œçš„ä»»åŠ¡
./kale_auto_dev.sh 5 --dry-run

# 3. å¼€å§‹è‡ªåŠ¨åŒ–å¼€å‘
./kale_auto_dev.sh 5

# 4. å¦‚æœä¸­æ–­ï¼Œç»§ç»­
./kale_auto_dev.sh --continue

# 5. æŸ¥çœ‹æœ€ç»ˆç»“æœ
cat claude-progress.txt
git log --oneline -10
```

---

**æç¤º**ï¼šè¿™ä¸ªè„šæœ¬å®ç°äº† Anthropic çš„ "Effective Harnesses for Long-Running Agents" æ–¹æ³•è®ºã€‚æ›´å¤šä¿¡æ¯è¯·å‚è€ƒï¼š
https://www.anthropic.com/engineering/effective-harnesses-for-long-running-agents
